[package]
name = "aumate"
version = "0.2.7"
edition = "2024"
rust-version = "1.85"
description = "Cross-platform desktop automation library with GUI support"
license = "MIT"
repository = "https://github.com/tegojs/bot"
homepage = "https://github.com/tegojs/bot"
documentation = "https://docs.rs/aumate"
readme = "README.md"
keywords = ["automation", "desktop", "gui", "mouse", "keyboard"]
categories = ["gui", "api-bindings", "os"]
authors = ["Zhang Lin <sealday@gmail.com>"]
exclude = [
    ".github/",
    "tests/",
    "examples/",
    "benches/",
]

[lib]
name = "aumate"
crate-type = ["lib"]

[package.metadata.docs.rs]
# Build docs with only features that don't require system libraries
# Excludes: screen (xcap requires libpipewire on Linux), gui (depends on screen)
no-default-features = true
features = ["input", "clipboard", "window"]
# Document all features for feature-gated items
all-features = false
# Set cfg flags for conditional compilation in docs
rustdoc-args = ["--cfg", "docsrs"]

[[bin]]
name = "aumate"
path = "src/main.rs"

[features]
default = ["input", "screen", "clipboard", "window", "gui"]
# Core features (no GUI deps)
input = ["dep:enigo"]
screen = ["dep:xcap", "dep:image"]
clipboard = ["dep:arboard", "dep:image"]
window = ["dep:active-win-pos-rs"]
# Event hooks for global keyboard/mouse interception
eventhooks = [
    "dep:lazy_static",
    "dep:cocoa",
    "dep:core-foundation",
    "dep:core-graphics",
    "dep:winapi",
    "dep:x11",
    "dep:mio",
    "dep:libc",
]
# GUI feature includes everything (float-window + screenshot UI)
gui = [
    "screen",
    "clipboard",
    "dep:winit",
    "dep:egui",
    "dep:egui-wgpu",
    "dep:egui-winit",
    "dep:wgpu",
    "dep:muda",
    "dep:tray-icon",
    "dep:glam",
    "dep:rfd",
    "dep:rand",
    "dep:noise",
    "dep:pollster",
    "dep:resvg",
    "dep:tiny-skia",
    "dep:raw-window-handle",
    "dep:fontdue",
    "dep:font-kit",
    # Clipboard manager dependencies
    "dep:rusqlite",
    "dep:chrono",
    "dep:serde",
    "dep:serde_json",
    "dep:uuid",
    "dep:regex",
    "dep:sha2",
]
# Speech-to-text feature
stt = [
    "input",
    "clipboard",
    "eventhooks",
    "dep:cpal",
    "dep:hound",
    "dep:whisper-rs",
    "dep:ort",
    "dep:ndarray",
    "dep:reqwest",
    "dep:futures-util",
    "dep:serde",
    "dep:serde_json",
    "dep:sha2",
]
# Click Helper feature
click_helper = [
    "gui",
    "input",
    "eventhooks",
]

[dependencies]
# Core (always included)
once_cell.workspace = true
tokio.workspace = true
anyhow.workspace = true
log.workspace = true
env_logger.workspace = true
thiserror.workspace = true

# Input feature
enigo = { workspace = true, optional = true }

# Screen feature
xcap = { workspace = true, optional = true }
image = { workspace = true, optional = true }

# Clipboard feature
arboard = { workspace = true, optional = true }

# Clipboard manager dependencies (always included with gui)
rusqlite = { workspace = true, optional = true }
chrono = { workspace = true, optional = true }
serde = { workspace = true, optional = true }
serde_json = { workspace = true, optional = true }
uuid = { workspace = true, optional = true }
regex = { workspace = true, optional = true }
sha2 = { workspace = true, optional = true }

# Window feature
active-win-pos-rs = { workspace = true, optional = true }

# GUI feature
winit = { workspace = true, optional = true }
egui = { workspace = true, optional = true }
egui-wgpu = { workspace = true, optional = true }
egui-winit = { workspace = true, optional = true }
wgpu = { workspace = true, optional = true }
muda = { workspace = true, optional = true }
tray-icon = { workspace = true, optional = true }
glam = { workspace = true, optional = true }
rfd = { workspace = true, optional = true }
rand = { workspace = true, optional = true }
noise = { workspace = true, optional = true }
pollster = { workspace = true, optional = true }
resvg = { workspace = true, optional = true }
tiny-skia = { workspace = true, optional = true }
raw-window-handle = { workspace = true, optional = true }
fontdue = { workspace = true, optional = true }
font-kit = { workspace = true, optional = true }

# Eventhooks feature
lazy_static = { version = "1.4", optional = true }

# STT feature dependencies
cpal = { workspace = true, optional = true }
hound = { workspace = true, optional = true }
whisper-rs = { workspace = true, optional = true }

ort = { workspace = true, optional = true }
ndarray = { workspace = true, optional = true }
reqwest = { workspace = true, optional = true }
futures-util = { workspace = true, optional = true }

[target.'cfg(target_os = "macos")'.dependencies]
objc = { workspace = true }
whisper-rs = { workspace = true, features = ["metal"], optional = true }
# Eventhooks macOS deps
cocoa = { version = "0.24", optional = true }
core-foundation = { version = "0.9", optional = true }
core-graphics = { version = "0.22", features = ["highsierra"], optional = true }

[target.'cfg(target_os = "windows")'.dependencies]
whisper-rs = { workspace = true, features = ["vulkan"], optional = true }
# Eventhooks Windows deps
winapi = { version = "0.3", features = ["winuser", "errhandlingapi", "processthreadsapi"], optional = true }

[target.'cfg(target_os = "linux")'.dependencies]
whisper-rs = { workspace = true, features = ["vulkan"], optional = true }
# Eventhooks Linux deps
x11 = { version = "2.18", features = ["xlib", "xrecord", "xinput"], optional = true }
mio = { version = "0.8", features = ["os-poll", "os-ext"], optional = true }
libc = { version = "0.2", optional = true }
